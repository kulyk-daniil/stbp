## Лабораторна робота № 5 [WINDOWS] ДОСЛІДЖЕННЯ ДИНАМІЧНИХ БІБЛІОТЕК

Виконав:
студент гр. КН-Н922б
Кулик Д.І.

Перевірив:
Бульба С.С.

## Мета
Отримати навички основ реверс-інженірингу "на практиці".

## Завдання
1.	Визначити мову програмування, на якої була написана бібліотека (C/C++, C#, Deplhi, Java). Визначення мови програмування дозволить найбільш ефективно використовувати "декомпілятор". При цьому, рекомендуються наступні декомпілятори:
o	для Java - jdgui, або нативний декомпілятор від Intellij IDEA
o	для C# - dotPeek
o	для Delphi - DeDe
o	для C/C++ - Ghidra, IDA Pro
2.	Визначити функції та їх прототипи, з яких складається динамічна бібліотека.
3.	Створити додаток, що підключає дану бібліотеку та визначити, що роблять функції getIV,getK.
4.	Декомпілювати функцію CRC_16_IBM. Судячи з її назви Вам буде не важко це зробити (бо її алгоритм завідомо відомий), але треба бути підібрати кректні коефіцієнти. Необхідно довести коректність реалізованого алгоритму через порівняння результатів з результатами роботи функції динамічної бібліотеки.
5.	Декомпілювати та переписати функції dec та enc. Який алгоритм вони використовують? Підсказка - це скорочення від encode, decode. Більшість алгоритмів шифрування використовують табличні дані, на базі яких використовується кодування. Знавши це - найбільш швидкий для вас варіант - визначити таблицю, що використовується, та знайти алгоритм, що її використовує. Реалізувати алгоритм на мові високого рівня, та довести коректність реалізованого алгоритму через порівняння результатів з результатами роботи функції динамічної бібліотеки.


## Хід роботи

## Важливі фрагменти програми
Встановлено Ghidra для декомпіляції бібліотеки

![Ghidra](/lab05/doc/ghidra.png)

Знайдені функції бібліотеки

![Бібліотека](/lab05/doc/dll_func.png)

Декомпільована функція CRC_16_IBM

![CRC_16_IBM](/lab05/doc/dec_crc.png)

Декомпільована функція getIV

![getIV](/lab05/doc/dec_iv.png)

Декомпільована функція getK

![getK](/lab05/doc/dec_getk.png)

Декомпільована функція enc

![enc](/lab05/doc/dec_enc.png)

Декомпільована функція dec

![dec](/lab12/doc/dec_dec.png)

Адреса функції CRC_16_IBM

![Адреса CRC](/lab05/doc/crc_address.png)

Код мовою С++ для виклику функції з dll

![Код С++](/lab05/doc/cpp_code.png)

Реалізована функція CRC_16_IBM

![Код CRC](/lab05/doc/crc_func.png)

Результат виконання програми

![Результат](/lab05/doc/result.png)

Функції dec та enc викликають підпрограми що мають вбудовані таблиці даних. Таблиця нижче співпадає з таблицею AES S-Box алгоритму AES розробленого у 2 лабораторній роботі.

![Порівняння](/lab05/doc/tables.png)

Таблиця S-Box для AES алгоритму

![s_box](/lab05/doc/s_box.png)

## Висновки
В результаті виконання лабораторної роботи було отримано навичок основ реверс-інженірингу "на практиці".